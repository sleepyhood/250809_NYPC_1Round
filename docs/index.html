<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>자물쇠 시뮬레이터 (이론 vs 체험)</title>
  <style>
   body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9f9f9;
      color: #333;
      padding: 30px;
      line-height: 1.6;
      text-align: center;
      max-width: 800px;
      margin: 0px auto;
      
    }

    h1 {
      font-size: 28px;
      color: #222;
      margin-bottom: 20px;
    }

    label {
      display: inline-block;
      margin: 10px 10px 10px 0;
      font-size: 16px;
    }

    input[type="number"] {
      width: 60px;
      padding: 5px 8px;
      font-size: 16px;
      margin-left: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      font-size: 16px;
      padding: 10px 16px;
      margin: 10px 8px 20px 0;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      opacity: 0.9;
    }

    button:active {
      transform: scale(0.98);
    }

    button.nth-of-type1 {
      background-color: #4a90e2;
      color: white;
    }

    button.nth-of-type2 {
      background-color: #50c878;
      color: white;
    }

    .button-container {
      margin: 15px 0;
    }

    .lock-btn {
      width: 50px;
      height: 50px;
      font-size: 18px;
      margin: 8px;
      border: 1px solid #ccc;
      border-radius: 8px;
      cursor: pointer;
      background-color: #fff;
      transition: background-color 0.2s ease;
    }

    .lock-btn:hover {
      background-color: #f0f0f0;
    }

    .status {
      margin-top: 20px;
      padding: 10px;
      background-color: #eef2f7;
      border-left: 5px solid #4a90e2;
      font-weight: bold;
      font-size: 16px;
    }

    .sequence {
      margin-top: 15px;
      font-size: 16px;
      padding: 8px;
      border: 1px solid #ddd;
      background-color: #fff;
      border-radius: 6px;
    }

    .log {
      margin-top: 20px;
      white-space: pre-wrap;
      background: #fcfcfc;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      max-height: 250px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      text-align: left;
    }</style>
</head>
<body>
  <h1>🔐 자물쇠 시뮬레이터</h1>

  <label>버튼 개수 (n): <input type="number" id="nInput" value="4" min="1" max = "6"/></label><br><br>
  <label>필요한 시퀀스 길이 (k): <input type="number" id="kInput" value="2" min="1" max="6"/></label><br><br>

  <button onclick="runAutoMode()" class="nth-of-type1">▶️ 자동 시뮬레이션 모드 (이론)</button>
  <button onclick="runManualMode()" class="nth-of-type2">🎮 사용자 체험 모드</button>

  <div class="button-container" id="buttonContainer"></div>
  <div class="status" id="statusBox">모드를 선택하세요.</div>
  <div class="sequence" id="progressBox"></div>
  <div class="log" id="logBox">[로그 영역]</div>

  <script>
    let n = 4, k = 2;
    let answer = [];
    let current = [];
    let attempts = 0;

    function updateStatus(msg) {
      document.getElementById("statusBox").innerText = msg;
    }

    function updateProgress() {
      document.getElementById("progressBox").innerText =
        `현재 입력: [${current.join(", ")}] | 시도 횟수: ${attempts}`;
    }

    function log(msg) {
      const box = document.getElementById("logBox");
      box.innerText += `\n${msg}`;
      box.scrollTop = box.scrollHeight;
    }

    function clearLog() {
      document.getElementById("logBox").innerText = "[로그 영역]";
    }
    

    // 📌 자동 이론 시뮬레이션 모드
    function runAutoMode() {
  n = parseInt(document.getElementById("nInput").value);
  k = parseInt(document.getElementById("kInput").value);

  document.getElementById("buttonContainer").innerHTML = "";
  updateStatus("▶️ 이론 모드 실행 중...");
  document.getElementById("progressBox").innerText = "";
  clearLog();

  let ans = 0;
  let steps = [];

  for (let i = 1; i <= k; i++) {
    for (let j = 1; j <= n - i; j++) {
      ans += i;
      // 단계와 시도 위치, 왜 틀렸는지 설명 추가
      if(i === 1) {
        steps.push(`[1단계] 버튼 ${j} → ❌ 틀렸어요. (첫 번째 버튼이 ${j}은 아닙니다.)\t현재까지 총 ${ans}번 버튼을 누름.`);
      } else {
        // i단계일 때, 앞단계 정답(●) 표시와 현재 시도 버튼 설명
        const triedButtons = Array(i - 1).fill('●').join(' ');
        steps.push(`[${i}단계] 시도: ${triedButtons} ${j} → ❌ 틀렸어요. (${i}번째 버튼이 ${j}은 아닙니다.)\t현재까지 총 ${ans}번 버튼을 누름.`);
      }
    }
  }

  ans += k;
  // 정답 시도도 친절히 설명
  const correctSequence = Array.from({ length: k }, (_, idx) => n - idx).join(" ");
  steps.push(`[${k}단계] 시도: ${correctSequence} → ✅ 정답입니다! 자물쇠가 열렸어요 🔓\t현재까지 총 ${ans}번 버튼을 누름.`);

  let idx = 0;
  const interval = setInterval(() => {
    if (idx < steps.length) {
      log(steps[idx]);
      idx++;
    } else {
      log(`🎯 이론 총 시도 횟수: ${ans}번`);
      updateStatus(`✅ 이론 시뮬레이션 완료`);
      clearInterval(interval);
    }
  }, 700);
}


    // 🎮 수동 체험 모드
    function runManualMode() {
      n = parseInt(document.getElementById("nInput").value);
      k = parseInt(document.getElementById("kInput").value);

      current = [];
      attempts = 0;
      clearLog();

      // 정답 시퀀스 생성
      answer = [];
      const used = new Set();
      while (answer.length < k) {
        let val = Math.floor(Math.random() * n) + 1;
        if (!used.has(val)) {
          used.add(val);
          answer.push(val);
        }
      }

      // 버튼 만들기
      const container = document.getElementById("buttonContainer");
      container.innerHTML = "";
      for (let i = 1; i <= n; i++) {
        const btn = document.createElement("button");
        btn.innerText = i;
        btn.className = "lock-btn";
        btn.onclick = () => handleManualInput(i);
        container.appendChild(btn);
      }

      updateStatus("🎮 자물쇠 체험 모드: 버튼을 눌러보세요.");
      updateProgress();
      console.log("🔐 디버그용 정답:", answer.join(" "));
    }
function handleManualInput(value) {
  attempts++;
  const nextIndex = current.length;
  const buttons = document.querySelectorAll(".lock-btn");

  if (value === answer[nextIndex]) {
    current.push(value);
    updateStatus(`✅ ${value} 버튼 맞았어요!`);
    // buttons[value - 1].style.backgroundColor = "#90ee90"; // 맞은 버튼은 초록색 표시 유지

        // ✅ 맞은 버튼 초록색 깜빡
    const btn = buttons[value - 1];
    btn.style.backgroundColor = "#90ee90";
    setTimeout(() => {
      btn.style.backgroundColor = "";
    }, 600);
  } else {
    updateStatus(`❌ ${value} 버튼 틀렸어요. 다시 처음부터 해요!`);

    // 🔁 버튼 색상 초기화 (모든 버튼)
    buttons.forEach(btn => {
      btn.style.backgroundColor = ""; // 초기화
    });

    // ❌ 틀린 버튼만 빨간색 깜빡
    const btn = buttons[value - 1];
    btn.style.backgroundColor = "#ff9999";
    setTimeout(() => {
      btn.style.backgroundColor = "";
    }, 400);

    // 입력한 정답 시퀀스는 리셋
    current = [];
  }

  updateProgress();

  if (current.length === k) {
    updateStatus(`🎉 자물쇠가 열렸어요! 총 시도 횟수: ${attempts}`);
  }
}

  </script>
</body>
</html>
